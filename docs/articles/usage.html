<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Usage • rpmodel</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Usage">
<meta property="og:description" content="rpmodel">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rpmodel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/usage.html">Usage</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stineb/rpmodel/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="usage_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Usage</h1>
                        <h4 class="author">Beni Stocker</h4>
            
            <h4 class="date">2021-02-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stineb/rpmodel/blob/master/vignettes/usage.Rmd"><code>vignettes/usage.Rmd</code></a></small>
      <div class="hidden name"><code>usage.Rmd</code></div>

    </div>

    
    
<p>The rpmodel package implements the P-model as described in Stocker et al. (2019) <em>Geosci. Mod. Dev.</em> The main function available through the package is <code><a href="../reference/rpmodel.html">rpmodel()</a></code>, which returns a list of quantities (see <code><a href="../reference/rpmodel.html">?rpmodel</a></code>) for a given set of inputs. An additional set of important functions that are used within <code><a href="../reference/rpmodel.html">rpmodel()</a></code> are also available through this package. Usage examples are given below.</p>
<p><strong>Important note:</strong></p>
<p>The P-model predicts how photosynthesis acclimates to a changing environment, coordinating stomatal conductance, Vcmax and Jmax. This yields a model that has the form of a light use efficiency model, where gross primary production scales linearly with absorbed light, as described in <a href="https://doi.org/10.5194/gmd-13-1545-2020">Stocker et al. 2020</a>. It is important to note that this implies that the P-model is valid only for simulating responses to the environment that evolve over the time scale at which the photosynthetic machinery (e.g., Rubisco) can be assumed to acclimate. Sensible choices are on the order of a couple of weeks to a month. In other words, the arguments (climatic forcing), provided to <code><a href="../reference/rpmodel.html">rpmodel()</a></code> should represent typical daytime mean values, averaged across a couple of weeks. The output is then representative also for average values across the same time scale.</p>
<div id="example-p-model-run" class="section level2">
<h2 class="hasAnchor">
<a href="#example-p-model-run" class="anchor"></a>Example P-model run</h2>
<p>Let’s run the P-model, without <span class="math inline">\(J_{\text{max}}\)</span> limitation (argument <code>method_jmaxlim = "none"</code>), for one point. The set of inputs, being temperature (<code>tc</code>), photosynthetic photon flux density (<code>ppfd</code>), vapour pressure deficit (<code>vpd</code>), ambient CO<span class="math inline">\(_2\)</span> (<code>co2</code>), elevation (<code>elv</code>), and fraction of absorbed photosynthetically active radiation (<code>fapar</code>). The quantum yield efficiency parameter is provided as an argument (<code>kphio</code>) and corresponds to <span class="math inline">\(\widehat{\varphi_0}\)</span> in Stocker et al. (2019) if the temperature-dependence of this parameter is ignored (argument <code>do_ftemp_kphio = FALSE</code>, corresponding to simulation setup ‘ORG’ in Stocker et al. (2019)), or to <span class="math inline">\(\widehat{c_L}\)</span> if the temperature-dependence of the quantum yield efficiency is included (argument <code>do_ftemp_kphio = TRUE</code>, used in simulation setups ‘BRC’ and ‘FULL’ in Stocker et al. (2019)). By default the optional argument <code>do_soilmstress</code> is set to <code>FALSE</code>, meaning that the empirical soil moisture stress function is not included. The unit cost ratio (<span class="math inline">\(\beta\)</span> in Stocker et al. (2019)) is given by argument <code>beta</code>.</p>
<p>To run the <code><a href="../reference/rpmodel.html">rpmodel()</a></code> function we can do:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stineb/rpmodel">rpmodel</a></span><span class="op">)</span>
<span class="va">out_pmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpmodel.html">rpmodel</a></span><span class="op">(</span> 
  tc             <span class="op">=</span> <span class="fl">20</span>,           <span class="co"># temperature, deg C</span>
  vpd            <span class="op">=</span> <span class="fl">1000</span>,         <span class="co"># Pa,</span>
  co2            <span class="op">=</span> <span class="fl">400</span>,          <span class="co"># ppm,</span>
  fapar          <span class="op">=</span> <span class="fl">1</span>,            <span class="co"># fraction  ,</span>
  ppfd           <span class="op">=</span> <span class="fl">300</span>,          <span class="co"># mol/m2/d,</span>
  elv            <span class="op">=</span> <span class="fl">0</span>,            <span class="co"># m.a.s.l.,</span>
  kphio          <span class="op">=</span> <span class="fl">0.049977</span>,     <span class="co"># quantum yield efficiency as calibrated for setup ORG by Stocker et al. 2020 GMD,</span>
  beta           <span class="op">=</span> <span class="fl">146</span>,          <span class="co"># unit cost ratio a/b,</span>
  c4             <span class="op">=</span> <span class="cn">FALSE</span>,
  method_optci   <span class="op">=</span> <span class="st">"prentice14"</span>,
  method_jmaxlim <span class="op">=</span> <span class="st">"none"</span>,
  do_ftemp_kphio <span class="op">=</span> <span class="cn">FALSE</span>,        <span class="co"># corresponding to setup ORG</span>
  do_soilmstress <span class="op">=</span> <span class="cn">FALSE</span>,        <span class="co"># corresponding to setup ORG</span>
  verbose        <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span></code></pre></div>
<pre><code>## Warning: Atmospheric pressure (patm) not provided. Calculating it as a function
## of elevation (elv), assuming standard atmosphere (101325 Pa at sea level).</code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">out_pmodel</span><span class="op">)</span></code></pre></div>
<pre><code>## $ca
## [1] 40.53
## 
## $gammastar
## [1] 3.339251
## 
## $kmm
## [1] 46.09928
## 
## $ns_star
## [1] 1.125361
## 
## $chi
## [1] 0.694352
## 
## $mj
## [1] 0.7123038
## 
## $mc
## [1] 0.3340838
## 
## $ci
## [1] 28.14209
## 
## $lue
## [1] 0.4275666
## 
## $gpp
## [1] 128.27
## 
## $iwue
## [1] 7.742446
## 
## $gs
## [1] 0.8621017
## 
## $vcmax
## [1] 31.96696
## 
## $vcmax25
## [1] 50.17764
## 
## $jmax
## [1] Inf
## 
## $rd
## [1] 0.5078163</code></pre>
<p>Above, we specified the model paramters (arguments <code>beta</code> and <code>kphio</code>). This overrides the defaults, where <code><a href="../reference/rpmodel.html">rpmodel()</a></code> uses the parameters as calibrated by Stocker et al. (2019), depending on the choices for arguments <code>do_ftemp_kphio</code> and <code>do_soilmstress</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kphio</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">do_ftemp_kphio</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">do_soilmstress</span>, <span class="fl">0.087182</span>, <span class="fl">0.081785</span><span class="op">)</span>, <span class="fl">0.049977</span><span class="op">)</span>
<span class="va">beta</span> <span class="op">=</span> <span class="fl">146.0</span>
<span class="va">apar_soilm</span> <span class="op">=</span> <span class="fl">0.0</span>
<span class="va">bpar_soilm</span> <span class="op">=</span> <span class="fl">0.73300</span></code></pre></div>
<p>The function returns a list of variables (see also man page by <code><a href="../reference/rpmodel.html">?rpmodel</a></code>), including <span class="math inline">\(V_{\mathrm{cmax}}\)</span>, <span class="math inline">\(g_s\)</span>, and all the parameters of the photosynthesis model (<span class="math inline">\(K\)</span>, <span class="math inline">\(\Gamma^{\ast}\)</span>), which are all internally consistent, as can be verified for… <span class="math display">\[
c_i = c_a - A / g_s = \chi c_a
\]</span></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">c_molmass</span> <span class="op">&lt;-</span> <span class="fl">12.0107</span>  <span class="co"># molecular mass of carbon</span>
<span class="va">kphio</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>         <span class="co"># quantum yield efficiency, value as used in the function call to rpmodel()</span>
<span class="va">ppfd</span> <span class="op">&lt;-</span> <span class="fl">300</span>           <span class="co"># mol/m2/d, value as used in the function call to rpmodel()</span>
<span class="va">fapar</span> <span class="op">&lt;-</span> <span class="fl">1</span>            <span class="co"># fraction, value as used in the function call to rpmodel()</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span> <span class="va">out_pmodel</span><span class="op">$</span><span class="va">ci</span> <span class="op">)</span></code></pre></div>
<pre><code>## [1] 28.14209</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span> <span class="va">out_pmodel</span><span class="op">$</span><span class="va">ca</span> <span class="op">-</span> <span class="op">(</span><span class="va">out_pmodel</span><span class="op">$</span><span class="va">gpp</span> <span class="op">/</span> <span class="va">c_molmass</span><span class="op">)</span> <span class="op">/</span> <span class="va">out_pmodel</span><span class="op">$</span><span class="va">gs</span> <span class="op">)</span></code></pre></div>
<pre><code>## [1] 28.14209</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span> <span class="va">out_pmodel</span><span class="op">$</span><span class="va">ca</span> <span class="op">*</span> <span class="va">out_pmodel</span><span class="op">$</span><span class="va">chi</span> <span class="op">)</span></code></pre></div>
<pre><code>## [1] 28.14209</code></pre>
<p>Yes.</p>
<p>And for… <span class="math display">\[
A = V_{\text{cmax}} \frac{c_i-\Gamma^{\ast}}{c_i + K} = \phi_0 I_{\text{abs}} \frac{c_i-\Gamma^{\ast}}{c_i + 2 \Gamma^{\ast}} = g_s (c_a - c_i)
\]</span></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span> <span class="va">out_pmodel</span><span class="op">$</span><span class="va">gpp</span> <span class="op">/</span> <span class="va">c_molmass</span> <span class="op">)</span></code></pre></div>
<pre><code>## [1] 10.67964</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span> <span class="va">out_pmodel</span><span class="op">$</span><span class="va">vcmax</span> <span class="op">*</span> <span class="op">(</span><span class="va">out_pmodel</span><span class="op">$</span><span class="va">ci</span> <span class="op">-</span> <span class="va">out_pmodel</span><span class="op">$</span><span class="va">gammastar</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">out_pmodel</span><span class="op">$</span><span class="va">ci</span> <span class="op">+</span> <span class="va">out_pmodel</span><span class="op">$</span><span class="va">kmm</span> <span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 10.67964</code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span> <span class="va">out_pmodel</span><span class="op">$</span><span class="va">gs</span> <span class="op">*</span> <span class="op">(</span><span class="va">out_pmodel</span><span class="op">$</span><span class="va">ca</span> <span class="op">-</span> <span class="va">out_pmodel</span><span class="op">$</span><span class="va">ci</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<pre><code>## [1] 10.67964</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span> <span class="va">kphio</span> <span class="op">*</span> <span class="va">ppfd</span> <span class="op">*</span> <span class="va">fapar</span> <span class="op">*</span> <span class="op">(</span><span class="va">out_pmodel</span><span class="op">$</span><span class="va">ci</span> <span class="op">-</span> <span class="va">out_pmodel</span><span class="op">$</span><span class="va">gammastar</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">out_pmodel</span><span class="op">$</span><span class="va">ci</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">out_pmodel</span><span class="op">$</span><span class="va">gammastar</span> <span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 10.68456</code></pre>
<p>Yes.</p>
<div id="elevation-and-pressure" class="section level3">
<h3 class="hasAnchor">
<a href="#elevation-and-pressure" class="anchor"></a>Elevation and pressure</h3>
<p>Above, atmospheric pressure (<code>patm</code>) was not provided as an argument, but elevation (<code>elv</code>) was. Hence the warning was printed (only when <code>verbose = TRUE</code>), saying: <code>Atmospheric pressure (patm) not provided. Calculating it as a function of elevation (elv),</code> <code>Assuming standard atmosphere (101325 Pa at sea level).</code>. Alternatively, we can provide atmospheric pressure (<code>patm</code>) as input, which overrides the argument <code>elv</code>.</p>
</div>
<div id="p-model-for-time-series" class="section level3">
<h3 class="hasAnchor">
<a href="#p-model-for-time-series" class="anchor"></a>P-model for time series</h3>
<p>The <code><a href="../reference/rpmodel.html">rpmodel()</a></code> function can also be invoked for time series, where <code>tc</code>, <code>vpd</code>, <code>co2</code>, <code>fapar</code>, <code>patm</code>, and <code>ppfd</code> are vectors.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1982</span><span class="op">)</span>
<span class="va">out_ts_pmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpmodel.html">rpmodel</a></span><span class="op">(</span> 
  tc             <span class="op">=</span> <span class="fl">20</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">5</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,
  vpd            <span class="op">=</span> <span class="fl">1000</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">5</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,
  co2            <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">400</span>, <span class="fl">5</span><span class="op">)</span>,
  fapar          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,
  ppfd           <span class="op">=</span> <span class="fl">300</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">5</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,
  elv            <span class="op">=</span> <span class="fl">0</span>,         
  kphio          <span class="op">=</span> <span class="fl">0.049977</span>,
  beta           <span class="op">=</span> <span class="fl">146</span>,
  c4             <span class="op">=</span> <span class="cn">FALSE</span>,
  method_optci   <span class="op">=</span> <span class="st">"prentice14"</span>,
  method_jmaxlim <span class="op">=</span> <span class="st">"none"</span>,
  do_ftemp_kphio <span class="op">=</span> <span class="cn">FALSE</span>,
  verbose        <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span></code></pre></div>
<pre><code>## Warning in sqrt((1/fact_jmaxlim)^2 - 1): NaNs produced</code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">out_ts_pmodel</span><span class="op">$</span><span class="va">gpp</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 119.8988 121.4950 131.8173 105.9518 140.3648</code></pre>
<p>Note that <code>gpp</code> (as well as all other returned variables) are now vectors of the same length as the vectors provided as inputs.</p>
</div>
<div id="p-model-in-the-tidyverse" class="section level3">
<h3 class="hasAnchor">
<a href="#p-model-in-the-tidyverse" class="anchor"></a>P-model in the tidyverse</h3>
<p>We can create a data frame (in <a href="https://www.tidyverse.org/">tidyverse</a> this is a tibble) and apply the <code><a href="../reference/rpmodel.html">rpmodel()</a></code> function to each row.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org">purrr</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1982</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>
  tc             <span class="op">=</span> <span class="fl">20</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">5</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,
  vpd            <span class="op">=</span> <span class="fl">1000</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">5</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,
  co2            <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">400</span>, <span class="fl">5</span><span class="op">)</span>,
  fapar          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,
  ppfd           <span class="op">=</span> <span class="fl">300</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">5</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span> out_pmodel <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">pmap</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">rpmodel</span>, 
    elv            <span class="op">=</span> <span class="fl">0</span>,         
    kphio          <span class="op">=</span> <span class="fl">0.049977</span>,
    beta           <span class="op">=</span> <span class="fl">146</span>,
    c4             <span class="op">=</span> <span class="cn">FALSE</span>,
    method_optci   <span class="op">=</span> <span class="st">"prentice14"</span>,
    method_jmaxlim <span class="op">=</span> <span class="st">"none"</span>,
    do_ftemp_kphio <span class="op">=</span> <span class="cn">FALSE</span>
    <span class="op">)</span> <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code></pre></div>
<p>Note that the new column <code>out_pmodel</code> now contains the list returned as output of the <code><a href="../reference/rpmodel.html">rpmodel()</a></code> function applied to each row separately. Additional (constant) arguments are just passed to <code><a href="https://purrr.tidyverse.org/reference/map2.html">purrr::pmap</a></code> as arguments.</p>
<p>If you prefer the elements of these lists to be in separate columns of <code>df</code>, use tidyr to do:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span> out_pmodel <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">out_pmodel</span>, <span class="op">~</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="va">out_pmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="auxiliary-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#auxiliary-functions" class="anchor"></a>Auxiliary functions</h2>
<p>A number of auxiliary functions, which are used within <code><a href="../reference/rpmodel.html">rpmodel()</a></code>, are available (public) through the package.</p>
<div id="instantaneous-temperature-scaling" class="section level3">
<h3 class="hasAnchor">
<a href="#instantaneous-temperature-scaling" class="anchor"></a>Instantaneous temperature scaling</h3>
<p>Different instantaneous temperature scaling functions are applied for <span class="math inline">\(V_\text{cmax}\)</span> and dark respiration (<span class="math inline">\(R_d\)</span>).</p>
<ul>
<li>
<code><a href="../reference/calc_ftemp_inst_vcmax.html">calc_ftemp_inst_vcmax()</a></code> calculates the instantaneous temperature response of <span class="math inline">\(V_\text{cmax}\)</span>. Let’s run the P-model for <code>tc = 10</code> (degrees C). The ratio of <span class="math inline">\(V_\text{cmax}/V_\text{cmax25}\)</span> should equal the instantaneous temperature scaling function for <span class="math inline">\(V_\text{cmax}\)</span> at 10 degrees C (calculated by <code><a href="../reference/calc_ftemp_inst_vcmax.html">calc_ftemp_inst_vcmax(10)</a></code>):</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out_pmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpmodel.html">rpmodel</a></span><span class="op">(</span> 
  tc             <span class="op">=</span> <span class="fl">10</span>,           <span class="co"># temperature, deg C</span>
  vpd            <span class="op">=</span> <span class="fl">1000</span>,         <span class="co"># Pa,</span>
  co2            <span class="op">=</span> <span class="fl">400</span>,          <span class="co"># ppm,</span>
  fapar          <span class="op">=</span> <span class="fl">1</span>,            <span class="co"># fraction  ,</span>
  ppfd           <span class="op">=</span> <span class="fl">300</span>,          <span class="co"># mol/m2/d,</span>
  elv            <span class="op">=</span> <span class="fl">0</span>,            <span class="co"># m.a.s.l.,</span>
  kphio          <span class="op">=</span> <span class="fl">0.049977</span>,     <span class="co"># quantum yield efficiency as calibrated for setup ORG by Stocker et al. 2020 GMD,</span>
  beta           <span class="op">=</span> <span class="fl">146</span>,          <span class="co"># unit cost ratio a/b,</span>
  method_optci   <span class="op">=</span> <span class="st">"prentice14"</span>,
  method_jmaxlim <span class="op">=</span> <span class="st">"none"</span>,
  do_ftemp_kphio <span class="op">=</span> <span class="cn">FALSE</span>,
  verbose        <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span></code></pre></div>
<pre><code>## Warning: Atmospheric pressure (patm) not provided. Calculating it as a function
## of elevation (elv), assuming standard atmosphere (101325 Pa at sea level).</code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Ratio Vcmax/Vcmax25      :"</span>, <span class="va">out_pmodel</span><span class="op">$</span><span class="va">vcmax</span><span class="op">/</span><span class="va">out_pmodel</span><span class="op">$</span><span class="va">vcmax25</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Ratio Vcmax/Vcmax25      : 0.260975632963417"</code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"calc_ftemp_inst_vcmax(10):"</span>, <span class="fu"><a href="../reference/calc_ftemp_inst_vcmax.html">calc_ftemp_inst_vcmax</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "calc_ftemp_inst_vcmax(10): 0.260975632963417"</code></pre>
<ul>
<li><p><code><a href="../reference/calc_ftemp_arrh.html">calc_ftemp_arrh()</a></code> Calculates the Arrhenius-type temperature response and is used inside <code><a href="../reference/calc_ftemp_inst_vcmax.html">calc_ftemp_inst_vcmax()</a></code>.</p></li>
<li><p><code><a href="../reference/calc_ftemp_inst_rd.html">calc_ftemp_inst_rd()</a></code> calculates the temperature response of dark respiration (<span class="math inline">\(R_d\)</span>), which is slightly less steep than that for <span class="math inline">\(V_\text{cmax}\)</span>:</p></li>
</ul>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"calc_ftemp_inst_rd(10):"</span>, <span class="fu"><a href="../reference/calc_ftemp_inst_rd.html">calc_ftemp_inst_rd</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "calc_ftemp_inst_rd(10): 0.284933345928884"</code></pre>
</div>
<div id="parameters-in-the-fvcb-model" class="section level3">
<h3 class="hasAnchor">
<a href="#parameters-in-the-fvcb-model" class="anchor"></a>Parameters in the FvCB model</h3>
<ul>
<li>
<code><a href="../reference/calc_gammastar.html">calc_gammastar()</a></code> calculates the CO<span class="math inline">\(_2\)</span> compensation point (<span class="math inline">\(\Gamma^\ast\)</span>) in the Farquhar-von Caemmerer-Berry model as a function of temperature (argument <code>tc</code>) and atmospheric pressure (argument <code>patm</code>). This is returned by the <code><a href="../reference/rpmodel.html">rpmodel()</a></code> function and by the separate auxiliary function <code><a href="../reference/calc_gammastar.html">calc_gammastar()</a></code>. <code><a href="../reference/calc_gammastar.html">calc_gammastar()</a></code> requires atmospheric pressure (<code>patm</code>) to be given as an argument (in addition to temperature). Corresponding to the <code><a href="../reference/rpmodel.html">rpmodel()</a></code> call above, let’s calculate this using the auxiliary function <code><a href="../reference/calc_patm.html">calc_patm()</a></code> with 0 metres above sea level, and assuming standard atmospheric pressure (101325 Pa at 0 m a.s.l.):</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"From rpmodel call :"</span>, <span class="va">out_pmodel</span><span class="op">$</span><span class="va">gammastar</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "From rpmodel call : 1.93016150706341"</code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"calc_gammastar(10):"</span>, <span class="fu"><a href="../reference/calc_gammastar.html">calc_gammastar</a></span><span class="op">(</span><span class="fl">10</span>, patm <span class="op">=</span> <span class="fu"><a href="../reference/calc_patm.html">calc_patm</a></span><span class="op">(</span>elv <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "calc_gammastar(10): 1.93016150706341"</code></pre>
<ul>
<li>
<code><a href="../reference/calc_kmm.html">calc_kmm()</a></code> calculates the Michaelis Menten coefficient for Rubisco-limited photosynthesis as a function of temperature (argument <code>tc</code>) and atmospheric pressure (argument <code>patm</code>). As above, <code><a href="../reference/calc_kmm.html">calc_kmm()</a></code> requires atmospheric pressure to be given as an argument (in addition to temperature). Corresponding to the <code><a href="../reference/rpmodel.html">rpmodel()</a></code> call above, let’s calculate this using the auxiliary function <code><a href="../reference/calc_patm.html">calc_patm()</a></code> with 0 metres above sea level, and assuming standard atmospheric pressure (101325 Pa at 0 m a.s.l.):</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"From rpmodel call:"</span>, <span class="va">out_pmodel</span><span class="op">$</span><span class="va">kmm</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "From rpmodel call: 19.6242174524746"</code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"calc_kmm(10)     :"</span>, <span class="fu"><a href="../reference/calc_kmm.html">calc_kmm</a></span><span class="op">(</span><span class="fl">10</span>, patm <span class="op">=</span> <span class="fu"><a href="../reference/calc_patm.html">calc_patm</a></span><span class="op">(</span>elv <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "calc_kmm(10)     : 19.6242174524746"</code></pre>
</div>
<div id="temperature-dependence-of-quantum-yield-efficiency" class="section level3">
<h3 class="hasAnchor">
<a href="#temperature-dependence-of-quantum-yield-efficiency" class="anchor"></a>Temperature dependence of quantum yield efficiency</h3>
<p>The temperature dependence of quantum yield efficiency is modelled following Bernacchi et al. (2003), if the argument to the <code><a href="../reference/rpmodel.html">rpmodel()</a></code> call <code>do_ftemp_kphio = TRUE</code>. This affects several quantities returned by the <code><a href="../reference/rpmodel.html">rpmodel()</a></code> call (GPP, LUE, Vcmax), and can be calculated direction using <code><a href="../reference/calc_ftemp_kphio.html">calc_ftemp_kphio()</a></code>.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out_pmodel_ftemp_kphio_ON</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpmodel.html">rpmodel</a></span><span class="op">(</span> 
  tc             <span class="op">=</span> <span class="fl">20</span>,           <span class="co"># temperature, deg C</span>
  vpd            <span class="op">=</span> <span class="fl">1000</span>,         <span class="co"># Pa,</span>
  co2            <span class="op">=</span> <span class="fl">400</span>,          <span class="co"># ppm,</span>
  fapar          <span class="op">=</span> <span class="fl">1</span>,            <span class="co"># fraction  ,</span>
  ppfd           <span class="op">=</span> <span class="fl">300</span>,          <span class="co"># mol/m2/d,</span>
  elv            <span class="op">=</span> <span class="fl">0</span>,            <span class="co"># m.a.s.l.,</span>
  do_ftemp_kphio <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span>
<span class="va">out_pmodel_ftemp_kphio_OFF</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpmodel.html">rpmodel</a></span><span class="op">(</span> 
  tc             <span class="op">=</span> <span class="fl">20</span>,           <span class="co"># temperature, deg C</span>
  vpd            <span class="op">=</span> <span class="fl">1000</span>,         <span class="co"># Pa,</span>
  co2            <span class="op">=</span> <span class="fl">400</span>,          <span class="co"># ppm,</span>
  fapar          <span class="op">=</span> <span class="fl">1</span>,            <span class="co"># fraction  ,</span>
  ppfd           <span class="op">=</span> <span class="fl">300</span>,          <span class="co"># mol/m2/d,</span>
  elv            <span class="op">=</span> <span class="fl">0</span>,            <span class="co"># m.a.s.l.,</span>
  do_ftemp_kphio <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"LUE ftemp_ON /LUE ftemp_OFF ="</span>, <span class="va">out_pmodel_ftemp_kphio_ON</span><span class="op">$</span><span class="va">lue</span> <span class="op">/</span> <span class="va">out_pmodel_ftemp_kphio_OFF</span><span class="op">$</span><span class="va">lue</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "LUE ftemp_ON /LUE ftemp_OFF = 1.07351301598735"</code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"GPP ftemp_ON /GPP ftemp_OFF ="</span>, <span class="va">out_pmodel_ftemp_kphio_ON</span><span class="op">$</span><span class="va">gpp</span> <span class="op">/</span> <span class="va">out_pmodel_ftemp_kphio_OFF</span><span class="op">$</span><span class="va">gpp</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "GPP ftemp_ON /GPP ftemp_OFF = 1.07351301598735"</code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Vcmax ftemp_ON /Vcmax ftemp_OFF ="</span>, <span class="va">out_pmodel_ftemp_kphio_ON</span><span class="op">$</span><span class="va">vcmax</span> <span class="op">/</span> <span class="va">out_pmodel_ftemp_kphio_OFF</span><span class="op">$</span><span class="va">vcmax</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Vcmax ftemp_ON /Vcmax ftemp_OFF = 1.07351301598735"</code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"calc_ftemp_kphio(20) ="</span>, <span class="fu"><a href="../reference/calc_ftemp_kphio.html">calc_ftemp_kphio</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "calc_ftemp_kphio(20) = 0.656"</code></pre>
</div>
<div id="soil-moisture-stress" class="section level3">
<h3 class="hasAnchor">
<a href="#soil-moisture-stress" class="anchor"></a>Soil moisture stress</h3>
<p>Similar to above (), the soil moisture dependence of LUE (and hence GPP, and Vcmax) can be calculated directly using the function <code><a href="../reference/calc_soilmstress.html">calc_soilmstress()</a></code> and affects several quantities returned by the <code><a href="../reference/rpmodel.html">rpmodel()</a></code> call (GPP, LUE, Vcmax):</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out_pmodel_soilmstress_OFF</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpmodel.html">rpmodel</a></span><span class="op">(</span> 
  tc             <span class="op">=</span> <span class="fl">20</span>,           <span class="co"># temperature, deg C</span>
  vpd            <span class="op">=</span> <span class="fl">1000</span>,         <span class="co"># Pa,</span>
  co2            <span class="op">=</span> <span class="fl">400</span>,          <span class="co"># ppm,</span>
  fapar          <span class="op">=</span> <span class="fl">1</span>,            <span class="co"># fraction  ,</span>
  ppfd           <span class="op">=</span> <span class="fl">300</span>,          <span class="co"># mol/m2/d,</span>
  elv            <span class="op">=</span> <span class="fl">0</span>,            <span class="co"># m.a.s.l.,</span>
  do_ftemp_kphio <span class="op">=</span> <span class="cn">FALSE</span>,
  do_soilmstress <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span>
<span class="va">out_pmodel_soilmstress_ON</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpmodel.html">rpmodel</a></span><span class="op">(</span> 
  tc             <span class="op">=</span> <span class="fl">20</span>,           <span class="co"># temperature, deg C</span>
  vpd            <span class="op">=</span> <span class="fl">1000</span>,         <span class="co"># Pa,</span>
  co2            <span class="op">=</span> <span class="fl">400</span>,          <span class="co"># ppm,</span>
  fapar          <span class="op">=</span> <span class="fl">1</span>,            <span class="co"># fraction  ,</span>
  ppfd           <span class="op">=</span> <span class="fl">300</span>,          <span class="co"># mol/m2/d,</span>
  elv            <span class="op">=</span> <span class="fl">0</span>,            <span class="co"># m.a.s.l.,</span>
  do_ftemp_kphio <span class="op">=</span> <span class="cn">FALSE</span>,
  do_soilmstress <span class="op">=</span> <span class="cn">TRUE</span>,
  soilm          <span class="op">=</span> <span class="fl">0.2</span>,
  apar_soilm     <span class="op">=</span> <span class="fl">0.1</span>,
  bpar_soilm     <span class="op">=</span> <span class="fl">0.7</span>,
  meanalpha      <span class="op">=</span> <span class="fl">0.2</span> 
  <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"LUE soilmstress_ON /LUE soilmstress_OFF ="</span>, <span class="va">out_pmodel_soilmstress_ON</span><span class="op">$</span><span class="va">lue</span> <span class="op">/</span> <span class="va">out_pmodel_soilmstress_OFF</span><span class="op">$</span><span class="va">lue</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "LUE soilmstress_ON /LUE soilmstress_OFF = 0.662222222222222"</code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"GPP soilmstress_ON /GPP soilmstress_OFF ="</span>, <span class="va">out_pmodel_soilmstress_ON</span><span class="op">$</span><span class="va">gpp</span> <span class="op">/</span> <span class="va">out_pmodel_soilmstress_OFF</span><span class="op">$</span><span class="va">gpp</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "GPP soilmstress_ON /GPP soilmstress_OFF = 0.662222222222222"</code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Vcmax soilmstress_ON /Vcmax soilmstress_OFF ="</span>, <span class="va">out_pmodel_soilmstress_ON</span><span class="op">$</span><span class="va">vcmax</span> <span class="op">/</span> <span class="va">out_pmodel_soilmstress_OFF</span><span class="op">$</span><span class="va">vcmax</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Vcmax soilmstress_ON /Vcmax soilmstress_OFF = 0.662222222222222"</code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"calc_soilmstress(0.2, apar_soilm = 0.1, bpar_soilm = 0.7, meanalpha = 0.2) ="</span>, <span class="fu"><a href="../reference/calc_soilmstress.html">calc_soilmstress</a></span><span class="op">(</span><span class="fl">0.2</span>, apar_soilm <span class="op">=</span> <span class="fl">0.1</span>, bpar_soilm <span class="op">=</span> <span class="fl">0.7</span>, meanalpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "calc_soilmstress(0.2, apar_soilm = 0.1, bpar_soilm = 0.7, meanalpha = 0.2) = 0.662222222222222"</code></pre>
<p><code><a href="../reference/calc_ftemp_arrh.html">calc_ftemp_arrh()</a></code> Calculates the Arrhenius-type temperature response.</p>
<!-- ## Response to CO2 -->
<!-- ```{r} -->
<!-- library(ggplot) -->
<!-- df <- tibble( -->
<!--   tc             = rep(20, 100), -->
<!--   vpd            = rep(1000, 100), -->
<!--   co2            = seq(360, 1000, length.out = 100), -->
<!--   fapar          = rep(1, 100), -->
<!--   ppfd           = rep(100, 100) -->
<!--   ) %>% -->
<!--   dplyr::mutate( out_pmodel_simpl = purrr::pmap(., rpmodel, -->
<!--     elv            = 0, -->
<!--     kphio          = 0.05, -->
<!--     beta           = 146, -->
<!--     method_optci   = "prentice14", -->
<!--     method_jmaxlim = "none", -->
<!--     do_ftemp_kphio = FALSE -->
<!--     ) ) %>% -->
<!--   dplyr::mutate( out_pmodel_full = purrr::pmap(dplyr::select(., 1:5), rpmodel,  -->
<!--     elv            = 0,          -->
<!--     kphio          = 0.05,          -->
<!--     beta           = 146, -->
<!--     method_optci   = "prentice14", -->
<!--     method_jmaxlim = "wang17", -->
<!--     do_ftemp_kphio = FALSE -->
<!--     ) ) %>%  -->
<!--   dplyr::mutate( out_pmodel_simpl = purrr::map(out_pmodel_simpl, ~as_tibble(.))) %>% -->
<!--   dplyr::mutate( out_pmodel_full  = purrr::map(out_pmodel_full,  ~as_tibble(.))) -->
<!-- df %>%  -->
<!--   tidyr::unnest(out_pmodel_full) %>%  -->
<!--   dplyr::select(co2, out_pmodel_simpl, gpp_full = gpp) %>%  -->
<!--   tidyr::unnest(out_pmodel_simpl) %>%  -->
<!--   dplyr::select(co2, gpp_full, gpp_simpl = gpp) %>%  -->
<!--   tidyr::gather(method, gpp, c(gpp_full, gpp_simpl)) %>%  -->
<!--   ggplot(aes(x = co2, y = gpp, color = method)) + -->
<!--   geom_line() -->
<!-- ``` -->
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Stocker, B. D., Wang, H., Smith, N. G., Harrison, S. P., Keenan, T. F., Sandoval, D., Davis, T., and Prentice, I. C.: P-model v1.0: An optimality-based light use efficiency model for simulating ecosystem gross primary production, Geosci. Model Dev. Discuss., <a href="https://doi.org/10.5194/gmd-2019-200" class="uri">https://doi.org/10.5194/gmd-2019-200</a>, in review, 2019.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Benjamin Stocker.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
